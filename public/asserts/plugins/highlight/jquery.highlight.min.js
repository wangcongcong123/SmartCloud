(function (a) {
    a.fn.extend({
        highlight: function (b, c) {
            var d = a(this), e = {
                onlyFirst: !0,
                classCountPrefix: "_",
                className: "jQuery_Highlight",
                fuzzy: !0,
                ignoredChars: /\r|\n|\s/,
                ignoredTags: /(script|style|iframe|object|embed)/i,
                callback: function () {
                }
            }, f = {
                searchStr: "", length: 0, pos: 0, range: null, found: !1, count: 1, search: function (b, d) {
                    this.searchStr = c.fuzzy ? a.trim(b) : b, this.length = this.searchStr.length, this.range = document.createRange(), this.startSearch(d, function (a) {
                        c.callback(f.surroundContent(a)), f.count++
                    })
                }, startSearch: function (b, d) {
                    b.contents().each(function () {
                        if (f.found && c.onlyFirst)return !1;
                        if (this.nodeType === 3) {
                            var b = this.textContent, e = b.length, g;
                            for (g = 0; g < e; g++) {
                                if (f.pos > 0 && c.fuzzy) {
                                    if (c.ignoredChars.test(b[g]))continue;
                                    if (c.ignoredChars.test(f.searchStr[f.pos]))while (c.ignoredChars.test(f.searchStr[f.pos]))f.pos++
                                }
                                if (b[g] === f.searchStr[f.pos]) {
                                    f.pos === 0 && f.range.setStart(this, g), f.pos++;
                                    if (f.pos === f.length)return f.found = !0, f.range.setEnd(this, ++g), d(f.range), !1
                                } else f.pos = 0
                            }
                        } else c.ignoredTags.test(this.tagName) || f.startSearch(a(this), d)
                    })
                }, surroundContent: function (b) {
                    var d = b.extractContents(), e = document.createElement("span");
                    return d.childNodes.length > 1 && a(d).contents().each(function () {
                        /(p|div)/i.test(this.tagName) && a(this).wrapInner('<span class="' + c.className + '">')
                    }), e.className = c.className + " " + c.classCountPrefix + f.count, e.appendChild(d), b.insertNode(e), e
                }
            };
            return c = a.extend(e, c), f.search(b, d), d
        }
    })
})(jQuery);